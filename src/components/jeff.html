<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GitHub Contribution Chart (Table Layout)</title>
    <style>
      table.github-chart {
        border-collapse: collapse;
        margin: 20px auto;
      }

      /* Each cell represents one day */
      .day-cell {
        width: 12px;
        height: 12px;
        padding: 0;
        margin: 0;
        border: 1px solid #ddd; /* optional to see boundaries */
      }

      .day {
        width: 12px;
        height: 12px;
        margin: 1px;
        border-radius: 2px;
      }

      /* Example color levels */
      .level-0 {
        background-color: #ebedf0;
      }
      .level-1 {
        background-color: #9be9a8;
      }
      .level-2 {
        background-color: #40c463;
      }
      .level-3 {
        background-color: #30a14e;
      }
      .level-4 {
        background-color: #216e39;
      }
    </style>
  </head>
  <body>
    <div id="app"></div>

    <script>
      // Sample contribution data
      const sampleData = [
        { date: "2025-01-01", count: 2 },
        { date: "2025-01-02", count: 7 },
        { date: "2025-01-03", count: 15 },
        { date: "2025-01-04", count: 1 },
        { date: "2025-01-05", count: 15 },
        { date: "2025-01-07", count: 3000 },
        { date: "2025-01-03", count: 15 },
        // Add more as needed
      ];

      // Convert sample data into a lookup map for easy access
      const contributionsMap = sampleData.reduce((acc, { date, count }) => {
        acc[date] = count;
        return acc;
      }, {});

      // 1. Generate all days of the current year
      function generateDaysOfYear(year = new Date().getFullYear()) {
        const start = new Date(year, 0, 1); // Jan 1 of the year
        const end = new Date(year + 1, 0, 1); // Jan 1 of next year
        const days = [];
        for (let d = new Date(start); d < end; d.setDate(d.getDate() + 1)) {
          days.push(new Date(d));
        }
        return days;
      }

      // 2. Group the days into "weeks" (array of 7 days max)
      //    We'll produce an array like [week0, week1, ...], where each week is an array of Date objects.
      function groupByWeeks(days) {
        const weeks = [];
        let currentWeek = [];

        days.forEach((day) => {
          // If it's Sunday (getDay() === 0) and we already have some days in currentWeek,
          // then push the currentWeek into weeks and start a new one.
          if (day.getDay() === 0 && currentWeek.length > 0) {
            weeks.push(currentWeek);
            currentWeek = [];
          }
          currentWeek.push(day);
        });

        // Push the last partial week if it exists
        if (currentWeek.length > 0) {
          weeks.push(currentWeek);
        }
        return weeks;
      }

      // 3. Determine intensity class based on the count
      function getIntensityClass(count) {
        if (!count || count <= 0) return "level-0";
        if (count <= 5) return "level-1";
        if (count <= 10) return "level-2";
        if (count <= 20) return "level-3";
        return "level-4";
      }

      const daysOfYear = generateDaysOfYear();
      const weeks = groupByWeeks(daysOfYear);

      // 4. Render as a table with 7 rows (one for each day of the week),
      //    and columns for each "week" from left to right.
      const table = document.createElement("table");
      table.className = "github-chart";

      const tbody = document.createElement("tbody");

      // We'll create 7 rows for Sunday (0) through Saturday (6).
      for (let rowIndex = 0; rowIndex < 7; rowIndex++) {
        const row = document.createElement("tr");

        // Each "week" is one column in the chart
        for (let weekIndex = 0; weekIndex < weeks.length; weekIndex++) {
          const cell = document.createElement("td");
          cell.className = "day-cell";

          // The date in the current "week" that matches rowIndex (by getDay())
          const day = weeks[weekIndex].find((d) => d.getDay() === rowIndex);

          if (day) {
            const dateString = day.toISOString().split("T")[0];
            const count = contributionsMap[dateString] || 0;
            const intensityClass = getIntensityClass(count);

            const dayDiv = document.createElement("div");
            dayDiv.className = `day ${intensityClass}`;
            dayDiv.title = `${count} contributions on ${dateString}`;

            cell.appendChild(dayDiv);
          }
          // else the cell remains empty (for partial first/last weeks)

          row.appendChild(cell);
        }
        tbody.appendChild(row);
      }

      table.appendChild(tbody);

      // 5. Append the table to the #app container
      document.getElementById("app").appendChild(table);
    </script>
  </body>
</html>
